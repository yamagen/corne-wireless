# Corne Wireless ノブを Panasonic EVQWGD001 に置き換える手順

---

## 概要

この資料は、Corne Wireless に標準搭載されているロータリーエンコーダを  
**Panasonic EVQWGD001 (水平型、押し込みスイッチ付き 6ピン)**  
へ置き換えるためのガイドです。

---

## 📦 使用部品

**Panasonic EVQWGD001**

- AliExpress 商品ページ  
  [https://ja.aliexpress.com/item/32990950196.html](https://ja.aliexpress.com/item/32990950196.html)

- 主な仕様
  - 水平型ロータリーエンコーダ
  - 押し込みスイッチ付き
  - 6ピン
  - 20デテント（ラッチ）

---

## 📐 ピン配置

以下の図は基板に対してピンを正面に見たときの配置です。

```
+---------------------+
| 本体                |
|                     |
| SW1 SW2 COM A B     |
+---------------------+
```

| ピン番号 | 信号             | 説明                 |
| -------- | ---------------- | -------------------- |
| 1        | SW1              | 押し込みスイッチ接点 |
| 2        | SW2              | 押し込みスイッチ接点 |
| 3        | COM (スイッチ)   | スイッチGND          |
| 4        | A                | エンコーダA相出力    |
| 5        | B                | エンコーダB相出力    |
| 6        | COM (エンコーダ) | エンコーダ共通GND    |

※ **スイッチとエンコーダでGNDが分離**されているので注意

---

## 🛠️ 配線例

### エンコーダ回転出力

- Aピン → マイコンのエンコーダA入力
- Bピン → マイコンのエンコーダB入力
- COM(エンコーダ) → GND

### 押し込みスイッチ

- SW1/SW2のいずれか → キーマトリクスの行または列
- COM(スイッチ) → GND

**スイッチは別のGPIOに配線する必要がある**

---

## 📈 推奨回路

ノイズ除去のため、A/Bピンに以下を推奨。

- **0.1uF セラミックコンデンサ**をGNDへ接続（チャタリング除去）
- 内蔵プルアップ/プルダウン設定

例:

```c
A --+-- 0.1uF -- GND
|
+-- GPIO入力
B --+-- 0.1uF -- GND
|
+-- GPIO入力
SW1 -- GPIO入力
SW2 -- GPIO入力
COM(スイッチ) -- GND
+---------------------+
```

同様にBも。

---

## ⚙️ ZMK設定例 (デバイスツリー)

ZMKでは以下のように記述します。

```dts
encoder {
    label = "ENCODER0";
    a-gpios = <&gpio1 13 GPIO_ACTIVE_LOW>;
    b-gpios = <&gpio1 14 GPIO_ACTIVE_LOW>;
    encoder-resolution = <4>;
};

```

    GPIO番号は環境によって異なります。

押し込みスイッチは通常のキーとして設定。

## 🚩 注意点

Corne Wireless基板はALPS 5ピン互換レイアウトが標準です。

EVQWGD001は6ピンで配置が異なるため、基板に直接はんだ付けできない可能性が高い。

対処方法

    ジャンパー線でピンを引き出して配線
    小型変換基板を介する
    押し込みスイッチのGNDはエンコーダCOMと共通化しない。

## 📝 実装のヒント

### ✅ まずピン位置が合うか現物合わせで確認

### ✅ 合わない場合

ピンを曲げて変換小型基板を使う

### ✅ 押し込みスイッチを別GPIOに割当🔗 資料

Panasonicデータシート (EVQWGD001) AliExpress商品ページZMKドキュメント https://zmk.dev/

#### ✨ 参考

このロータリーエンコーダは小型・低背で完成度が高く、Corne Wirelessのカスタマイズに最適です。

---
